/*amd /page/P00043.xml 10987 bb19d9197d285ca43fb25ff68cb55812dd61631211df4274117e269c5a6a50b2 */
define({declaration:{A:{version:'1.0',encoding:'UTF-8'}},E:[{T:1,N:'html',A:{xmlns:'http://www.w3.org/1999/xhtml','xmlns:ev':'http://www.w3.org/2001/xml-events','xmlns:w2':'http://www.inswave.com/websquare','xmlns:xf':'http://www.w3.org/2002/xforms'},E:[{T:1,N:'head',E:[{T:1,N:'w2:type',E:[{T:3,text:'COMPONENT'}]},{T:1,N:'w2:buildDate'},{T:1,N:'w2:MSA'},{T:1,N:'xf:model',E:[{T:1,N:'w2:dataCollection',A:{baseNode:'map'},E:[{T:1,N:'w2:dataList',A:{baseNode:'list',id:'dlt_page_history',repeatNode:'map',saveRemovedData:'true',style:''},E:[{T:1,N:'w2:columnInfo',E:[{T:1,N:'w2:column',A:{dataType:'text',id:'updated_date',name:'업데이트 날짜'}},{T:1,N:'w2:column',A:{dataType:'text',id:'version',name:'버전'}},{T:1,N:'w2:column',A:{dataType:'text',id:'description',name:'설명'}},{T:1,N:'w2:column',A:{dataType:'text',id:'author',name:'작성인'}}]},{T:1,N:'w2:data',A:{use:'true'},E:[{T:1,N:'w2:row',E:[{T:1,N:'updated_date',E:[{T:4,cdata:'20220706'}]},{T:1,N:'version',E:[{T:4,cdata:'01'}]},{T:1,N:'description',E:[{T:4,cdata:'최초작성'}]},{T:1,N:'author',E:[{T:4,cdata:'InswaveSystems'}]}]}]}]},{T:1,N:'w2:dataList',A:{id:'dlt_ExcelData'},E:[{T:1,N:'w2:columnInfo',E:[{T:1,N:'w2:column',A:{id:'type',name:'type',dataType:'text'}},{T:1,N:'w2:column',A:{id:'Money',name:'Money',dataType:'text'}},{T:1,N:'w2:column',A:{id:'manufacturer',name:'manufacturer',dataType:'text'}},{T:1,N:'w2:column',A:{id:'Trading',name:'Trading',dataType:'text'}},{T:1,N:'w2:column',A:{id:'Market',name:'Market',dataType:'text'}},{T:1,N:'w2:column',A:{id:'Inputdate',name:'Inputdate',dataType:'text'}},{T:1,N:'w2:column',A:{id:'picture',name:'picture',dataType:'text'}}]},{T:1,N:'w2:data',A:{xmlns:'',use:'true'},E:[{T:1,N:'w2:row',E:[{T:1,N:'type',E:[{T:4,cdata:'체리마루'}]},{T:1,N:'Money',E:[{T:4,cdata:'3000'}]},{T:1,N:'manufacturer',E:[{T:4,cdata:'해태'}]},{T:1,N:'Trading',E:[{T:4,cdata:'15'}]},{T:1,N:'Market',E:[{T:4,cdata:'Mart'}]},{T:1,N:'Inputdate',E:[{T:4,cdata:'20180314'}]},{T:1,N:'picture',E:[{T:4,cdata:'/img/example/icecream/cherry.png'}]}]},{T:1,N:'w2:row',E:[{T:1,N:'type',E:[{T:4,cdata:'쿠&쿠'}]},{T:1,N:'Money',E:[{T:4,cdata:'5000'}]},{T:1,N:'manufacturer',E:[{T:4,cdata:'빙그레'}]},{T:1,N:'Trading',E:[{T:4,cdata:'10'}]},{T:1,N:'Market',E:[{T:4,cdata:'Mart'}]},{T:1,N:'Inputdate',E:[{T:4,cdata:'20180314'}]},{T:1,N:'picture',E:[{T:4,cdata:'/img/example/icecream/cooandcoo.png'}]}]},{T:1,N:'w2:row',E:[{T:1,N:'type',E:[{T:4,cdata:'엑셀런트'}]},{T:1,N:'Money',E:[{T:4,cdata:'5900'}]},{T:1,N:'manufacturer',E:[{T:4,cdata:'빙그레'}]},{T:1,N:'Trading',E:[{T:4,cdata:'7'}]},{T:1,N:'Market',E:[{T:4,cdata:'Mart'}]},{T:1,N:'Inputdate',E:[{T:4,cdata:'20180315'}]},{T:1,N:'picture',E:[{T:4,cdata:'/img/example/icecream/excelent.png'}]}]},{T:1,N:'w2:row',E:[{T:1,N:'type',E:[{T:4,cdata:'구구스타'}]},{T:1,N:'Money',E:[{T:4,cdata:'3500'}]},{T:1,N:'manufacturer',E:[{T:4,cdata:'롯데'}]},{T:1,N:'Trading',E:[{T:4,cdata:'5'}]},{T:1,N:'Market',E:[{T:4,cdata:'Mart'}]},{T:1,N:'Inputdate',E:[{T:4,cdata:'20180315'}]},{T:1,N:'picture',E:[{T:4,cdata:'/img/example/icecream/googoo.png'}]}]},{T:1,N:'w2:row',E:[{T:1,N:'type',E:[{T:4,cdata:'누가바'}]},{T:1,N:'Money',E:[{T:4,cdata:'3000'}]},{T:1,N:'manufacturer',E:[{T:4,cdata:'해태'}]},{T:1,N:'Trading',E:[{T:4,cdata:'3'}]},{T:1,N:'Market',E:[{T:4,cdata:'Department'}]},{T:1,N:'Inputdate',E:[{T:4,cdata:'20180316'}]},{T:1,N:'picture',E:[{T:4,cdata:'/img/example/icecream/nuga.png'}]}]},{T:1,N:'w2:row',E:[{T:1,N:'type',E:[{T:4,cdata:'돼지바'}]},{T:1,N:'Money',E:[{T:4,cdata:'3000'}]},{T:1,N:'manufacturer',E:[{T:4,cdata:'롯데'}]},{T:1,N:'Trading',E:[{T:4,cdata:'12'}]},{T:1,N:'Market',E:[{T:4,cdata:'Department'}]},{T:1,N:'Inputdate',E:[{T:4,cdata:'20180316'}]},{T:1,N:'picture',E:[{T:4,cdata:'/img/example/icecream/pig.png'}]}]},{T:1,N:'w2:row',E:[{T:1,N:'type',E:[{T:4,cdata:'셀렉션'}]},{T:1,N:'Money',E:[{T:4,cdata:'4000'}]},{T:1,N:'manufacturer',E:[{T:4,cdata:'롯데'}]},{T:1,N:'Trading',E:[{T:4,cdata:'5'}]},{T:1,N:'Market',E:[{T:4,cdata:'Department'}]},{T:1,N:'Inputdate',E:[{T:4,cdata:'20180317'}]},{T:1,N:'picture',E:[{T:4,cdata:'/img/example/icecream/selection.png'}]}]},{T:1,N:'w2:row',E:[{T:1,N:'type',E:[{T:4,cdata:'붕어싸만코'}]},{T:1,N:'Money',E:[{T:4,cdata:'5000'}]},{T:1,N:'manufacturer',E:[{T:4,cdata:'빙그레'}]},{T:1,N:'Trading',E:[{T:4,cdata:'15'}]},{T:1,N:'Market',E:[{T:4,cdata:'supermarket'}]},{T:1,N:'Inputdate',E:[{T:4,cdata:'20180317'}]},{T:1,N:'picture',E:[{T:4,cdata:'/img/example/icecream/ssmanko.png'}]}]},{T:1,N:'w2:row',E:[{T:1,N:'type',E:[{T:4,cdata:'투게더'}]},{T:1,N:'Money',E:[{T:4,cdata:'5000'}]},{T:1,N:'manufacturer',E:[{T:4,cdata:'빙그레'}]},{T:1,N:'Trading',E:[{T:4,cdata:'3'}]},{T:1,N:'Market',E:[{T:4,cdata:'supermarket'}]},{T:1,N:'Inputdate',E:[{T:4,cdata:'20180318'}]},{T:1,N:'picture',E:[{T:4,cdata:'/img/example/icecream/together.png'}]}]},{T:1,N:'w2:row',E:[{T:1,N:'type',E:[{T:4,cdata:'호두마루'}]},{T:1,N:'Money',E:[{T:4,cdata:'3000'}]},{T:1,N:'manufacturer',E:[{T:4,cdata:'해태'}]},{T:1,N:'Trading',E:[{T:4,cdata:'23'}]},{T:1,N:'Market',E:[{T:4,cdata:'supermarket'}]},{T:1,N:'Inputdate',E:[{T:4,cdata:'20180318'}]},{T:1,N:'picture',E:[{T:4,cdata:'/img/example/icecream/walnut.png'}]}]}]}]}]},{T:1,N:'w2:workflowCollection'},{T:1,N:'xf:submission',A:{id:'sbm',ref:'',target:'data:json,dlt_ExcelData',action:'/ws5/sample/data/excelImg.json',method:'post',mediatype:'application/json',encoding:'UTF-8',instance:'',replace:'',errorHandler:'',customHandler:'',mode:'asynchronous',processMsg:'','ev:submit':'','ev:submitdone':'scwin.sbm_submitdone','ev:submiterror':'',abortTrigger:''}}]},{T:1,N:'w2:layoutInfo'},{T:1,N:'w2:publicInfo',A:{method:''}},{T:1,N:'script',A:{lazy:'false',type:'text/javascript'},E:[{T:4,cdata:function(scopeObj){with(scopeObj){
scwin.onpageload = function () {

};

/**
 * [이미지 포함 엑셀 다운로드] 버튼 클릭 시
 */
scwin.btn_excel_onclick = function (e) {
    /*
    websquare_home -> config -> websquare.xml

    <websquare>
        <excel>
            <download>
                <baseDir value="서비스 기준경로(ROOT)" />
            
                <!--  예)
                    <baseDir value="C:\WRM\WORKSPACE\.metadata\.plugins\org.eclipse.wst.server.core\tmp1\wtpwebapps" />
                    <baseDir value="C:\WRM\WORKSPACE\ws5\WebContent"/>   --> 이와같은 실제 wtp서버가 아닌 로컬경로는 넣으면 안된다. 이유는
                -->
            </download>
        </excel>
        
        .....
    </websquare>
    
    
    ※주의사항 : 
    1) 대용량에서는 적합하지 않으므로 사용하지 않는다.
    2) 이미지 경로가 was 서버에 존재해야 다운로드 할 수 있다.      
       이클립스의 wtp서버가 아닌 로컬파일의 경로(C:\WRM\WORKSPACE\ws5\WebContent)가 아닌 wtp서버의 경로를 넣어야 한다.
       로컬파일의 경로를 넣을 경우, 웹스퀘어 화면에서 이미지 업로드후 다운로드받을 때 새로고침을 하지 않으면 실제로 업로드가 됐다고 인식하지 않아서 이미지를 내려받을 수 없다.
       그러므로 로컬에서 테스트할 때는 wtp서버의 경로를 넣는 것이 바람직하다.
    
    */

    var options = {};
    options.fileName = "ExcelImgDownload.xlsx";
    options.headerRowHeight = 40;     // [필수] header 높이 
    options.rowHeight = "50";         // [필수] body 높이 
    options.useImage = "true";        // [필수] inputType="image"인 경우 이미지 다운로드 사용

    grd_Excel.advancedExcelDownload(options);
};
}}}]}]},{T:1,N:'body',A:{'ev:onpageload':'scwin.onpageload'},E:[{T:1,N:'xf:group',A:{class:'sub_contents',id:'',style:''},E:[{T:1,N:'xf:group',A:{class:'mb_def tar',id:'',style:''},E:[{T:1,N:'xf:trigger',A:{class:'btn_cm','ev:onclick':'scwin.btn_excel_onclick',id:'btn_excel',style:'',type:'button'},E:[{T:1,N:'xf:label',E:[{T:4,cdata:'이미지 포함 엑셀 다운로드'}]}]}]},{T:1,N:'w2:gridView',A:{autoFit:'allColumn',class:'wq_gvw mb_def',copyOption:'display',dataDragSelect:'true',dataList:'data:dlt_ExcelData',defaultCellHeight:'30',dragStartFunction:'','ev:oncellclick':'','ev:oneditend':'','ev:onfilereadend':'scwin.grd_Excel_onfilereadend',fixedColumnWithHidden:'true',focusFlow:'',focusMode:'',id:'grd_Excel',ignoreCellClick:'false',ignoreToggleOnDisabled:'false',rowNumHeaderValue:'No',rowNumStatusResize:'',rowNumVisible:'false',rowNumWidth:'30',rowStatusHeaderValue:'',scrollByColumn:'false',scrollByColumnAdaptive:'false',style:'height:100px;',summaryAuto:'false',tooltipFormatter:'',useShiftKey:'true',visibleRowNum:'15'},E:[{T:1,N:'w2:caption',A:{id:'caption2',style:'',value:'this is a grid caption.'}},{T:1,N:'w2:header',A:{id:'header2',style:''},E:[{T:1,N:'w2:row',A:{id:'row3',style:''},E:[{T:1,N:'w2:column',A:{blockSelect:'false',displayMode:'label',id:'column37',inputType:'text',style:'',value:'사진',width:'70'}},{T:1,N:'w2:column',A:{blockSelect:'false',displayMode:'label',id:'column35',inputType:'text',style:'',value:'종류',width:'70'}},{T:1,N:'w2:column',A:{blockSelect:'false',displayMode:'label',id:'column33',inputType:'text',style:'',value:'가격',width:'70'}},{T:1,N:'w2:column',A:{blockSelect:'false',displayMode:'label',id:'column31',inputType:'text',style:'',value:'제조사',width:'70'}},{T:1,N:'w2:column',A:{blockSelect:'false',displayMode:'label',id:'column29',inputType:'text',style:'',value:'거래량',width:'70'}},{T:1,N:'w2:column',A:{blockSelect:'false',displayMode:'label',id:'column27',inputType:'text',style:'',value:'시장',width:'70'}},{T:1,N:'w2:column',A:{blockSelect:'false',displayMode:'label',id:'column25',inputType:'text',style:'',value:'기준일',width:'70'}}]}]},{T:1,N:'w2:gBody',A:{id:'gBody2',style:''},E:[{T:1,N:'w2:row',A:{id:'row4',style:''},E:[{T:1,N:'w2:column',A:{blockSelect:'false',displayMode:'label',id:'picture',imageHeight:'30',imageWidth:'30',inputType:'image',style:'',value:'',width:'70'}},{T:1,N:'w2:column',A:{blockSelect:'false',displayMode:'label',id:'type',inputType:'text',style:'',textAlign:'left',value:'',width:'70'}},{T:1,N:'w2:column',A:{blockSelect:'false',dataType:'number',displayFormat:'#,###',displayMode:'label',id:'Money',inputType:'text',style:'',textAlign:'right',value:'',width:'70'}},{T:1,N:'w2:column',A:{blockSelect:'false',dataType:'text',displayFormat:'',displayMode:'label',id:'manufacturer',inputType:'text',style:'',textAlign:'center',value:'',width:'70'}},{T:1,N:'w2:column',A:{blockSelect:'false',displayMode:'label',id:'Trading',inputType:'text',style:'',textAlign:'right',value:'',width:'70'}},{T:1,N:'w2:column',A:{blockSelect:'false',dataType:'text',displayFormat:'',displayMode:'label',id:'Market',inputType:'text',style:'',textAlign:'center',value:'',width:'70'}},{T:1,N:'w2:column',A:{blockSelect:'false',dataType:'date',displayFormat:'yyyy-MM-dd',displayMode:'label',id:'Inputdate',inputType:'text',style:'',value:'',width:'70'}}]}]}]}]}]}]}]})